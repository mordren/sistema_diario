{% extends "base.html" %}
{% block title %}Lista de AnÃ¡lises{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>ğŸ“‹ AnÃ¡lises de ReputaÃ§Ã£o Realizadas</h2>
        <a href="{{ url_for('home') }}" class="btn btn-primary">â• Nova AnÃ¡lise</a>
    </div>

    {% if analises and analises|length > 0 %}
    <div class="row">
        {% for analise in analises %}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-header 
                    {% if analise.risco_reputacao|lower in ['critica', 'alta', 'alto'] %}bg-danger text-white
                    {% elif analise.risco_reputacao|lower in ['media', 'medio'] %}bg-warning
                    {% else %}bg-success text-white{% endif %}">
                    <h5 class="mb-0">
                        <i class="bi bi-person-circle"></i> {{ analise.nome }}
                    </h5>
                </div>
                
                <div class="card-body">
                    {% if analise.cargo %}
                    <p class="card-text">
                        <strong>ğŸ’¼ Cargo:</strong> {{ analise.cargo }}
                    </p>
                    {% endif %}
                    
                    <p class="card-text">
                        <strong>ğŸ“… Data:</strong> 
                        {% if analise.data_analise %}
                            {% if analise.data_analise is string %}
                                {{ analise.data_analise[:10] }}
                            {% else %}
                                {{ analise.data_analise.strftime('%d/%m/%Y') }}
                            {% endif %}
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                    
                    <p class="card-text">
                        <strong>ğŸš¨ Risco:</strong>
                        <span class="badge 
                            {% if analise.risco_reputacao|lower in ['critica', 'alta', 'alto'] %}bg-danger
                            {% elif analise.risco_reputacao|lower in ['media', 'medio'] %}bg-warning text-dark
                            {% else %}bg-success{% endif %}">
                            {{ analise.risco_reputacao|upper if analise.risco_reputacao else "N/A" }}
                        </span>
                    </p>
                    
                    <p class="card-text">
                        <strong>ğŸ¯ PolÃªmicas:</strong> 
                        <span class="badge bg-secondary">
                            {{ analise.total_polemicas if analise.total_polemicas is defined else 0 }}
                        </span>
                    </p>
                    
                    {% if analise.resumo_analise %}
                    <p class="card-text text-muted small">
                        {{ analise.resumo_analise[:100] }}{% if analise.resumo_analise|length > 100 %}...{% endif %}
                    </p>
                    {% endif %}
                </div>
                
                <div class="card-footer bg-transparent">
                    <a href="{{ url_for('detalhar_analise', analise_id=analise.id) }}" 
                       class="btn btn-sm btn-primary w-100">
                        ğŸ” Ver Detalhes
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="alert alert-info mt-4">
        <strong>â„¹ï¸ Total de anÃ¡lises:</strong> {{ analises|length }}
    </div>
    
    {% else %}
    <div class="alert alert-warning text-center py-5">
        <h4>ğŸ“­ Nenhuma anÃ¡lise encontrada</h4>
        <p>Ainda nÃ£o hÃ¡ anÃ¡lises realizadas. Clique no botÃ£o acima para criar a primeira anÃ¡lise.</p>
        <a href="{{ url_for('home') }}" class="btn btn-primary mt-3">
            â• Criar Primeira AnÃ¡lise
        </a>
    </div>
    {% endif %}
</div>

<style>
.card {
    transition: transform 0.2s, box-shadow 0.2s;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
}

.card-header h5 {
    font-size: 1.1rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.badge {
    font-size: 0.85rem;
    padding: 0.4em 0.6em;
}
</style>
{% endblock %}